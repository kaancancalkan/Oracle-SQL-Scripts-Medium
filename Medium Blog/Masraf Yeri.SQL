/* Formatted on 12/10/2023 5:33:06 PM (QP5 v5.388) */
--PAAM. ASS_ATTRIBUTE2ye baktým DOLUYSA Aldým 
--boþ ise pozisyon HR_ALL_POSITIONS_Fde ATTRIBUTE1 doluysa aldým  
--boþ ise departman HR_ORGANIZATION_UNITS ATTRIBUTE1 aldým (boþ olamaz)

SELECT (CASE
            WHEN PAAM.ASS_ATTRIBUTE2 IS NOT NULL THEN PAAM.ASS_ATTRIBUTE2
            WHEN HAPF.ATTRIBUTE1 IS NOT NULL THEN HAPF.ATTRIBUTE1
            ELSE HOU.ATTRIBUTE1
        END)    AS MASRAF
  FROM PER_ALL_ASSIGNMENTS_M  PAAM,
       HR_ALL_POSITIONS_f     HAPF,
       HR_ORGANIZATION_UNITS  HOU,
       PER_ALL_PEOPLE_F       PAPF
 WHERE     TRUNC (SYSDATE) BETWEEN PAPF.EFFECTIVE_START_DATE
                               AND PAPF.EFFECTIVE_END_DATE
       AND TRUNC (SYSDATE) BETWEEN PAAM.EFFECTIVE_START_DATE
                               AND PAAM.EFFECTIVE_END_DATE
       AND TRUNC (SYSDATE) BETWEEN HAPF.EFFECTIVE_START_DATE
                               AND HAPF.EFFECTIVE_END_DATE
       AND PAAM.PERSON_ID = PAPF.PERSON_ID
       AND PAAM.POSITION_ID = HAPF.POSITION_ID
       AND HOU.ORGANIZATION_ID = PAAM.ORGANIZATION_ID